<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="My Site Atom Feed"><title data-react-helmet="true">Blog | My Site</title><meta data-react-helmet="true" property="og:title" content="Blog | My Site"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="description" content="Blog"><meta data-react-helmet="true" property="og:description" content="Blog"><meta data-react-helmet="true" property="og:url" content="https://reantoilpc.github.io//en/blog"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_posts_list"><link data-react-helmet="true" rel="icon" href="/en/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://reantoilpc.github.io//en/blog"><link data-react-helmet="true" rel="alternate" href="https://reantoilpc.github.io//en/blog" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://reantoilpc.github.io//blog" hreflang="zh-TW"><link data-react-helmet="true" rel="alternate" href="https://reantoilpc.github.io//blog" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.fbe54615.css">
<link rel="preload" href="/en/assets/js/runtime~main.624765fb.js" as="script">
<link rel="preload" href="/en/assets/js/main.20fce998.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="Ray Hsu" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/en/img/logo.svg" alt="Ray Hsu" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">RH工作筆記</b></a><a class="navbar__item navbar__link" href="/en/docs/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/en/blog/2022-12-29-miniProfiler-guide">miniProfiler 使用介紹</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/en/blog/2022-08-17-efcore-guide">efcore 使用介紹</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/en/blog/2022-08-02-global-produces-attribute">Produces Attribute 全域設定</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/en/blog/2022-07-21-nuget-package-Enums.NET">Enums.NET 使用</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/en/blog/postman-environment-variable">Postman 環境變數設定</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/2022-12-29-miniProfiler-guide">miniProfiler 使用介紹</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-12-29T00:00:00.000Z" itemprop="datePublished">December 29, 2022</time> · <!-- -->3 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/reantoilpc.png" alt="Ray Hsu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Hsu</span></a></div><small class="avatar__subtitle" itemprop="description">C# 後端工程師</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="使用原因">使用原因<a class="hash-link" href="#使用原因" title="Direct link to heading">​</a></h2><p>最近協助團隊優化排程執行效率，想要解決執行效率不好問題，就需要知道問題出在那個環節才能進行修正。過去在處理這類問題，都是用肉眼看程式碼和經驗來判斷，而這樣方式很沒有效率，而且不一定改對方向，反而花大量時間卻沒有解決真正問題。</p><p>為了有效率的找出問題點在那裡，導入<code>miniProfiler</code>該套件，該套件不止可以有效記錄程式執行所花費時間，更可以記錄SQL執行花費時間及產生相對的語法，方便調整SQL語法。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="miniprofiler-介紹">MiniProfiler 介紹<a class="hash-link" href="#miniprofiler-介紹" title="Direct link to heading">​</a></h2><p>MiniProfiler 是一個專門分析應用系統和UI介面的工具，透過工具可以解析出程式所花費時間，以及執行那些程式碼，有這些內容可以幫助我們調整優化系統效能。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="如何使用">如何使用<a class="hash-link" href="#如何使用" title="Direct link to heading">​</a></h2><p>安裝相關套件</p><ul><li>MiniProfiler.AspNetCore</li><li>MiniProfiler.AspNetCore.Mvc</li><li>MiniProfiler.EntityFrameworkCore</li></ul><p><a href="https://localhost:64137/profiler/results-index" target="_blank" rel="noopener noreferrer">監控路徑</a></p><p>Startup.cs 設定</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    services.AddMiniProfiler(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //訪問地址路由根目錄；預設為：/mini-profiler-resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.RouteBasePath = &quot;/profiler&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //資料快取時間</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (options.Storage as MemoryCacheStorage).CacheDuration = TimeSpan.FromMinutes(3);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //sql格式化設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.SqlFormatter = new InlineFormatter();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //跟蹤連線開啟關閉</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.TrackConnectionOpenClose = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //介面主題顏色方案;預設淺色</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.ColorScheme = ColorScheme.Dark;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //.net core 3.0以上：對MVC過濾器進行分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // options.EnableMvcFilterProfiling = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //對檢視進行分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // options.EnableMvcViewProfiling = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //控制訪問頁面授權，預設所有人都能訪問</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //options.ResultsAuthorize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //要控制分析哪些請求，預設說有請求都分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //options.ShouldProfile;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //內部異常處理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //options.OnInternalError = e =&gt; MyExceptionLogger(e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.IgnorePath(&quot;/health&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options.IgnorePath(&quot;/swagger&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }).AddEntityFramework();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app.UseMiniProfiler();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="用法">用法<a class="hash-link" href="#用法" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    var miniProfiler = MiniProfiler.StartNew(&quot;更新服務的支付工具&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    using (miniProfiler.Step(&quot;RefreshSubscribedService&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 監控的程式碼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    miniProfiler.Stop();</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="使用套件">使用套件<a class="hash-link" href="#使用套件" title="Direct link to heading">​</a></h2><p>使用 AOP 套件建立 MiniProfiler.Extensions 套件</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Profiler(&quot;Test&quot;,&quot;RefreshSubscribedService&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public async Task&lt;bool&gt; RefreshSubscribedService(string Id)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/mini-profiler">miniProfiler</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/2022-08-17-efcore-guide">efcore 使用介紹</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-08-17T00:00:00.000Z" itemprop="datePublished">August 17, 2022</time> · <!-- -->7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/reantoilpc.png" alt="Ray Hsu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Hsu</span></a></div><small class="avatar__subtitle" itemprop="description">C# 後端工程師</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="efcore-建議寫法">EFCore 建議寫法<a class="hash-link" href="#efcore-建議寫法" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="repository-回傳">Repository 回傳<a class="hash-link" href="#repository-回傳" title="Direct link to heading">​</a></h3><p>Repository 設計概念，希望透過傳入條件值篩選資料出來。如果單純查詢一個資料表這樣寫法沒有問題，但通常在顯示或是處理資料，不會只有查一個資料表，往往都要查詢好幾個資料表，進行 Join 後才是我們要的結果。</p><p>如果 Repository 回傳是 IEnumerable、List、Array 這些類型，等同於立刻執行一段 SQL 語法，意思就是 Join 幾個資料表就執行幾次 SQL 語法，這樣寫法是很消耗資料庫效能，而且執行效率也比較慢，因為是分別 Query 資料表並沒有使用到 SQL Join 功能。</p><p>在 EFCore 可以使用 IQueryable 進行延遲執行取得資料，意思就是無論 Join 幾個資料表，都還不會Query 資料表，而是等到 ToListAsync ，EFCore 才會產生相對應的 SQL 語法，這時候就會組出 SQL Join 語法，好處就是只對資料庫查詢一次、而且是篩選過的資料，在網路傳輸也會比較快一些。</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    // Bad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public IEnumerable&lt;EpkAccAccount&gt; Find(Expression&lt;Func&lt;EpkAccAccount, bool&gt;&gt; expression)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return _context.EpkAccAccount.Where(expression);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Good</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public IQueryable&lt;EpkAccAccount&gt; FindAsync(Expression&lt;Func&lt;EpkAccAccount, bool&gt;&gt; expression)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return expression == null ? _context.EpkAccAccount : _context.EpkAccAccount.Where(expression);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }    </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="select-必要欄位">Select 必要欄位<a class="hash-link" href="#select-必要欄位" title="Direct link to heading">​</a></h3><p>使用 SQL 查詢，官方不建議 <code>select * from table</code> 查出所有欄位，只要針對需要欄位就可以。使用 EFCore 也是如此，如果不指定欄位，直接回傳 Entity 就會把所有欄位查詢出來。</p><p>建議在查詢時候，針對必要欄位查詢就可以，才不會造成非必要查詢效能浪費。</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Bad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var epkAccId = &quot;6006746649&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IEnumerable&lt;EpkAccAccount&gt; epkAccAccount = _context.EpkAccAccount.Where(x =&gt; x.EpkAccId == epkAccId).ToListAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Good</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var epkAccId = &quot;6006746649&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IEnumerable&lt;AccountDto&gt; accountDto = _context.EpkAccAccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        .Where(x =&gt; x.EpkAccId == epkAccId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        .Select(x =&gt; new AccountDto </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                            EpkAccId = x.EpkAccId, Lpr = x.Lpr, IdNo = x.IdNo </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        .ToListAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="like-查詢">Like 查詢<a class="hash-link" href="#like-查詢" title="Direct link to heading">​</a></h3><p>在 EFCore Link 查詢，不建議使用 <code>StartsWith</code>, <code>EndsWith</code>, <code>Contains</code> 這幾個關鍵字查詢，EFCore 並不會轉換成 SQL Like，反而會轉換使用 SQL 函數查詢，雖然查詢結果一樣，但當資料量大時，查詢的效率就會變差。</p><p>在 EFCore 使用 <code>StartsWith</code>, <code>EndsWith</code>, <code>Contains</code> 關鍵字查詢，對應產生 SQL 語法</p><div class="codeBlockContainer_J+bg language-SQL theme-code-block"><div class="codeBlockContent_csEI SQL"><pre tabindex="0" class="prism-code language-SQL codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Contains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT [traTx].[TRA_TX_ID], [traTx].[CHANNEL_CODE], [traTx].[TRANSACTION_TIME]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM [EPK_ACC_TRA_TX] AS [traTx]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE CHARINDEX(&#x27;P96&#x27;, [traTx].[CHANNEL_CODE]) &gt; 0 OR &#x27;P96&#x27; = N&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- StartsWith</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT [traTx].[TRA_TX_ID], [traTx].[CHANNEL_CODE], [traTx].[TRANSACTION_TIME]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM [EPK_ACC_TRA_TX] AS [traTx]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE LEFT([traTx].[CHANNEL_CODE], LEN(&#x27;P96&#x27;)) = &#x27;P96&#x27; OR &#x27;P96&#x27; = N&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- EndsWith</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SELECT [traTx].[TRA_TX_ID], [traTx].[CHANNEL_CODE], [traTx].[TRANSACTION_TIME]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FROM [EPK_ACC_TRA_TX] AS [traTx]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE RIGHT([traTx].[CHANNEL_CODE], LEN(&#x27;P96&#x27;)) = &#x27;P96&#x27; OR &#x27;P96&#x27; = N&#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>如果要 Like 查詢，請要改用 <code>EF.Functions</code> 來查詢。</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    // Bad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var channelCode = &quot;P96&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _context.EpkAccTraTx.Where(x =&gt; x.ChannelCode.StartsWith(channelCode));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Good</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var channelCode = &quot;P96&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _context.EpkAccTraTx.Where(x =&gt; EF.Functions.Like(x.ChannelCode, $&quot;{channelCode}%&quot;));   </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="inner-join">Inner Join<a class="hash-link" href="#inner-join" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var smsHistories = _context.EpkAccSmshistory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var traTxs = _context.EpkAccTraTx;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var traNoticeViews = await</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from sms in smsHistories join traTx in traTxs on sms.TraTxId equals traTx.TraTxId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        where traTx.ServiceId == 6 &amp;&amp; traTx.TransactionCode == &quot;01&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        select new TraNoticeView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ChannelCode = traTx.ChannelCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OpenFilter = sms.OpenFilter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TransactionDate = traTx.TransactionTime.Date,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Filter = sms.Filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ).ToListAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="left-join">Left Join<a class="hash-link" href="#left-join" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var smsHistories = _context.EpkAccSmshistory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var traTxs = _context.EpkAccTraTx;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var traNoticeViews = await</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from sms in smsHistories join traTx in traTxs on sms.TraTxId equals traTx.TraTxId into histories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from sms in histories.DefaultIfEmpty()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        where traTx.ServiceId == 6 &amp;&amp; traTx.TransactionCode == &quot;01&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        select new TraNoticeView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ChannelCode = traTx.ChannelCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OpenFilter = sms.OpenFilter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TransactionDate = traTx.TransactionTime.Date,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Filter = sms.Filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ).ToListAsync();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="group-by">Group By<a class="hash-link" href="#group-by" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    var smsHistories = _context.EpkAccSmshistory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var traTxs = _context.EpkAccTraTx;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var traNoticeViews = await</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from sms in smsHistories join traTx in traTxs on sms.TraTxId equals traTx.TraTxId into histories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        from sms in histories.DefaultIfEmpty()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        where traTx.ServiceId == 6 &amp;&amp; traTx.TransactionCode == &quot;01&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        select new TraNoticeView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ChannelCode = traTx.ChannelCode,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OpenFilter = sms.OpenFilter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            TransactionDate = traTx.TransactionTime.Date,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Filter = sms.Filter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .GroupBy(x =&gt; new {x.TransactionDate, x.Filter})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .ToDictionaryAsync(x =&gt; x.Key, x =&gt; new TraNoticeArrivalCount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TransactionDate = x.Key.TransactionDate,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Filter = x.Key.Filter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrivalCount = x.Count()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                             </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="efcore-withnolock">EFCore WithNoLock<a class="hash-link" href="#efcore-withnolock" title="Direct link to heading">​</a></h3><p>在 MS SQL 下 Select 語法，通常會建議加上<code>WithNoLock</code>，避免 Select 資料表，同時間該資料正在異動中，暫時性的 Lock 等待作業完成期間，造成使用者連線 Timeout 的問題。</p><p>雖然 EFCore 不支援自動補上 WithNoLock 的語法，但可以透過<code>IsolationLevel</code>（交易隔離等級）達到同樣的效果。</p><p>隔離等級有分這幾種，各個差異如下（預設為ReadCommitted）：
| 隔離等級 | 說明 |
| -- | -- |
| Chaos | 無法覆寫來自隔離程度更深之交易的暫止變更 |
| ReadCommitted | 在交易期間無法讀取 Volatile 資料，但可以修改該資料 |
| ReadUncommitted | 在交易期間可以讀取和修改 Volatile 資料。 |
| RepeatableRead | 在交易期間可以讀取 Volatile 資料，但無法修改該資料。 在交易期間可以加入新資料。 |
| Serializable | 在交易期間可以讀取 Volatile 資料，但無法修改該資料，且不能加入新資料。 |
| Snapshot | 可以讀取 Volatile 資料。 交易會在修改資料之前，先驗證在最初讀取資料後是否有另一個交易已變更該資料。 如果資料已更新，則會引發錯誤， 如此可允許交易回到先前所認可的資料值。當您升級使用 Snapshot 隔離層級建立的交易時，會擲回具有錯誤訊息「無法升級 IsolationLevel 為快照的交易」的 InvalidOperationException。 |
| Unspecified | 使用與指定不同的隔離等級，但無法判斷該等級。 如果設定這個值，會擲回例外狀況。 |</p><p>要避免上述該問題，一般指定隔離等級為 ReadUncommitted。</p><p>在程式裡要使用<code>WithNoLock</code>功能，要先從下載<code>Fetc.Core.EntityFramewrokCore</code>套件，只要回傳資料類型是<code>IQueryable</code>就可以使用，使用範例如下。</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var repository = _epkUnitOfWork.GetRepository&lt;EpkExcWhitelist&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var epkWhitelistDtos = repository.GetAll(x =&gt; x.UploadDate &gt; startDate &amp;&amp; x.UploadDate &lt;= endDate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                     .ToListWithNoLock();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="savechanges">SaveChanges<a class="hash-link" href="#savechanges" title="Direct link to heading">​</a></h2><p>EFCore 是透過<code>DbContext.DbSet&lt;T&gt;</code>對資料進行Add、Update、Remov，當下還不會寫入資料庫，而是延遲到<code>SaveChanges</code>後才會真正寫入資料庫，而每次呼叫<code>SaveChanges</code>時，多筆資料異動指令會自動包成一個 Transaction，任一個動作失敗均會觸發 Rollback。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/efcore">efcore</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/2022-08-02-global-produces-attribute">Produces Attribute 全域設定</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-08-02T00:00:00.000Z" itemprop="datePublished">August 2, 2022</time> · <!-- -->2 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/reantoilpc.png" alt="Ray Hsu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Hsu</span></a></div><small class="avatar__subtitle" itemprop="description">C# 後端工程師</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="application-model">Application model<a class="hash-link" href="#application-model" title="Direct link to heading">​</a></h2><p>Application Model 定義 MVC 應用中各種對象和行為，包含Application、Controller、Action、Parameter、Router、Page、Property、Filter等等，上述的功能可以透過<code>慣例</code>(convention)來擴充客製自己的需求，並設定全域或屬性來使用</p><p>ASP.NET Core MVC 透過 IApplicationModelProvider 定義擴充的類別來載入應用程式，官方建議沒有特別需求，盡量不使用<code>provider pattern</code>而是使用<code>conventions</code>進行功能擴充</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="實作-produceresponsetypemodelconvention">實作 ProduceResponseTypeModelConvention<a class="hash-link" href="#實作-produceresponsetypemodelconvention" title="Direct link to heading">​</a></h2><p>在網路上查到的程式範例都是繼承<code>IApplicationModelProvider</code>因此我改用<code>IApplicationModelConvention</code>來實作，範例如下</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ProduceResponseTypeModelConvention : IApplicationModelConvention</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void Apply(ApplicationModel application)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        foreach (var controller in application.Controllers)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            foreach (var action in controller.Actions)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Type? returnType = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (action.ActionMethod.ReturnType.GenericTypeArguments.Any())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (action.ActionMethod.ReturnType.GenericTypeArguments[0].GetGenericArguments().Any())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        returnType = action.ActionMethod.ReturnType.GenericTypeArguments[0].GetGenericArguments()[0];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                AddUniversalStatusCodes(action, returnType);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                var actionParametersExist = action.Parameters.Any();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (actionParametersExist)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    AddProducesResponseTypeAttribute(action, typeof(void), StatusCodes.Status404NotFound);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void AddUniversalStatusCodes(ActionModel action, Type? returnType)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AddProducesResponseTypeAttribute(action, returnType, StatusCodes.Status200OK);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            AddProducesResponseTypeAttribute(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                action, typeof(ExceptionResponse), StatusCodes.Status500InternalServerError);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void AddProducesResponseTypeAttribute(ActionModel action, Type? returnType, int statusCodeResult)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (returnType != null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                action.Filters.Add(new ProducesResponseTypeAttribute(returnType, statusCodeResult));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            else if (returnType is null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                action.Filters.Add(new ProducesResponseTypeAttribute(statusCodeResult));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 擴充功能注入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">service.AddControllers(options =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    options.Conventions.Add(new ProduceResponseTypeModelConvention());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="參考資料來源">參考資料來源<a class="hash-link" href="#參考資料來源" title="Direct link to heading">​</a></h2><p><a href="https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/application-model?view=aspnetcore-6.0" target="_blank" rel="noopener noreferrer">官方文件說明</a>
<a href="https://www.cnblogs.com/hohoa/p/12134019.html" target="_blank" rel="noopener noreferrer">在Asp.Net Core中使用ModelConvention实现全局过滤器隔离</a>
<a href="https://stackoverflow.com/questions/58047020/net-core-api-make-producesresponsetype-global-parameter-or-automate" target="_blank" rel="noopener noreferrer">Net Core API: Make ProducesResponseType Global Parameter or Automate</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/nuget">nuget</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/produces">Produces</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/attribute">Attribute</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/2022-07-21-nuget-package-Enums.NET">Enums.NET 使用</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-07-21T00:00:00.000Z" itemprop="datePublished">July 21, 2022</time> · <!-- -->3 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/reantoilpc.png" alt="Ray Hsu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Hsu</span></a></div><small class="avatar__subtitle" itemprop="description">C# 後端工程師</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="使用原因">使用原因<a class="hash-link" href="#使用原因" title="Direct link to heading">​</a></h2><p>最近在協助團隊在舊的專案底下開發新 API 功能，該功能是從資料庫取得資料後，經過過濾和整理再回傳前端頁面。
目前遇到一個小問題，該資料的某個欄位存的是<code>A</code>、<code>D</code>、<code>U</code>在前端頁面顯示分別新增、刪除、修改，在顯示上都需要<code>HardCode</code>處理，這樣的寫法造成程式碼的<code>壞味道（Bad Smell）</code>出現。</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (actionStatus == &quot;A&quot;) { retrun &quot;新增&quot;; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (actionStatus == &quot;D&quot;) { retrun &quot;刪除&quot;; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (actionStatus == &quot;U&quot;) { retrun &quot;更新&quot;; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="壞味道bad-smell">壞味道（Bad Smell）<a class="hash-link" href="#壞味道bad-smell" title="Direct link to heading">​</a></h2><p>為什麼HardCode方式，會有壞味道（Bad Smell）出現呢?
因為當<code>actionStatus</code>又增加一種類型，例如<code>Q</code>查詢，勢必就要加一行程式，這樣就違反開放封閉原則</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="改善方式">改善方式<a class="hash-link" href="#改善方式" title="Direct link to heading">​</a></h2><p>即然要解決HardCode問題，就要把<code>A</code>、<code>D</code>、<code>U</code>的定義要移到另一個Class或是Enum上面，而不是散落在各程式碼裡。目前想到有二個套件，可以解決我的問題</p><ol><li><a href="https://github.com/ardalis/SmartEnum" target="_blank" rel="noopener noreferrer">SmartEnum</a></li><li><a href="https://github.com/TylerBrinkley/Enums.NET" target="_blank" rel="noopener noreferrer">Enums.NET</a></li></ol><p>後來決定使用Enums.NET，原因是</p><ul><li>因為舊的專案已經在使用Enum，如果導入<code>SmartEnum</code>新的做法造成維護上的混亂。</li><li>Enums.NET比較類似原有的Enum的使用方式，比較容易理解。</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="先建立symbolattribute和actionstatusenum">先建立<code>SymbolAttribute</code>和<code>ActionStatusEnum</code><a class="hash-link" href="#先建立symbolattribute和actionstatusenum" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SymbolAttribute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[AttributeUsage(AttributeTargets.Field)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class SymbolAttribute : Attribute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public string Symbol { get; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public SymbolAttribute(string symbol)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Symbol = symbol;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ActionStatusEnum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public enum ActionStatusEnum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Symbol(&quot;A&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Description(&quot;新增&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Add,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Symbol(&quot;D&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Description(&quot;刪除&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Delete,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Symbol(&quot;U&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Description(&quot;更新&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="使用enumsnet取得文字說明">使用<code>Enums.NET</code>取得文字說明<a class="hash-link" href="#使用enumsnet取得文字說明" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Get SymbolAttribute Format</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var symbolFormat = Enums.RegisterCustomEnumFormat(x =&gt; x.Attributes.Get&lt;SymbolAttribute&gt;()?.Symbol);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Return Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (Enums.TryParse&lt;ActionStatusEnum&gt;(actionStatus, false, out var status, symbolFormat))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return status.AsString(EnumFormat.Description);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/nuget">nuget</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/unittest">unittest</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/enums-net">Enums.NET</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/postman-environment-variable">Postman 環境變數設定</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-05-31T00:00:00.000Z" itemprop="datePublished">May 31, 2022</time> · <!-- -->2 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/reantoilpc.png" alt="Ray Hsu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/reantoilpc" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Hsu</span></a></div><small class="avatar__subtitle" itemprop="description">C# 後端工程師</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="postman-environment-variable-簡介">Postman Environment Variable 簡介<a class="hash-link" href="#postman-environment-variable-簡介" title="Direct link to heading">​</a></h2><p>Postman 是一套測試 API 工具，藉著 Environment Variable 的設定，可以很方便切換環境，進行 API 功能驗證，概念很像 asp.net 的 appsettings，只要設定好要置換的內容，就可以使用。</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="environment-variable-設定">Environment Variable 設定<a class="hash-link" href="#environment-variable-設定" title="Direct link to heading">​</a></h2><ul><li>在 Environment 設定不同環境</li></ul><p><img alt="image" src="/en/assets/images/2022-05-31-environment-variable-01-7c9909d4b00655ce220f728fdbb493c4.png"></p><ul><li>設定 Variable Name 和 Value</li></ul><p><img alt="image" src="/en/assets/images/2022-05-31-environment-variable-02-ee9398cb1a66ad17cb0bf24fb2981b5b.png"></p><ul><li>使用 Variable 取代原本 Api Url</li></ul><p><img alt="image" src="data:image/png;base64,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qkzUH9OzFlWFh+UMCU3psgqwJ8FcP9esJ6j7ELQTcZPU/kdnykUGYoJRW1WEw/ZZAZpQLkwQg2BlDtt9JufwK9mODS7bwEa5YEEEAr4pkyeWuSD2RS8Co8ntfrSObpAe2mMmWNrals28jkob6HqZYXasV+bDHSfivTqPLREReZPXgm298MEYERsCfH0C75nYc/Fr4blgGwjjI0sQc/5VLH77tG38tiIyBbmTe6Lslb9g7XeyzkF4t5sR5i8+S12+gDJ3V45tkRbGGYsQ/cVqzNr3jawDDPcvwSjN23h4W6mskfTLMfOlAaiYk461LkObey4vPtAMw3PbMPpKPqZmtXb8bEtiMGdNFiJOpiM959f1d+q5tkxE5o5sjEYxsv5bTm2mDKlYsRCJfsXIuHee9y7VS0REKu8HW/pV8lywBUL6pCArdSC6XinF/hfyYfumvCcenfY44m/1x7eH1+CP7zcET4/oORKvzLgHN1lP4tCfN+F1NTzHImuRAeH+36D89dVY8ZW6phPblcfarq3Blton3cSVyJ2XCJ2m4QprsFQg/5lULHea7oyIiLyBwZa8wpPBVtUpEAOCOqP6ogWOw7OVntnQKxdw/EdZ4Skun88fMd274KdLFpT/LKsaudpgS75EDslQQu13VSg64G5ACREReRqDLXmFx4NtB8FgS0REdP147wINRERERETXEHtsySv+nR5bIiIioqvBHlu6bm7wkRsRERG1D+yxJa9orsd2sNWKdIsFPX52cwZWB/MPPz/kaLU40bmzrCEiIqLrgT22dM099N13PhNqFbfU1SGVwy6IiIiuOwZbuuZcfkXQwfniMREREXU0DLZ0zb3RrRtqOnWC0mfrC7dzfn746403intERER0PXGMLXkFZ0UgIiKia409tkRERETkExhsiYiIiMgnNBtsb7iBs3QSERERUcfgNtheuXIF/v7+skRERERE1L65DbY//PADAgMD0akTRysQERERUfvnNrVaLBb88ssvuPHGG9G5c2cOSyAiIiKids3tdF92Wq0WXbp04bAEapO6ujr4+fnJEhEREZH3tRhsiYiIiIg6Ag6gJSIiIiKfwGBLRERERD6BwZaIiIiIfAKDLRERERH5BAZbIiIiIvIJDLZERERE5BMYbImIiIjIBwD/DwqnhkSfVgu5AAAAAElFTkSuQmCC"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="透過-response-回寫-environment-variable">透過 Response 回寫 Environment Variable<a class="hash-link" href="#透過-response-回寫-environment-variable" title="Direct link to heading">​</a></h2><p>使用 Postman 測試 API 會要使用 AccessToken 進行權限的驗證，因此在測試前需要先登入取得 AccessToken 然後複製貼上 Auth 對應欄位，有幾支 API 就要複製幾次，非常麻煩，因此可以透過 Environment Variable 簡化重複貼上的動作。</p><ul><li>先設定 AccessToken 變數，放在 Auth 對應欄位</li></ul><p><img alt="image" src="/en/assets/images/2022-05-31-environment-variable-04-a90033c4ccb91826946c5c9ca645c45a.png"></p><ul><li>在取得 AccessToken API 的 Tests 裡輸入 Javascript 語法，當成功取得 AccessToken 回寫 Environment Variable</li></ul><p><img alt="image" src="/en/assets/images/2022-05-31-environment-variable-05-cf3a5169a53c9034a887be1a788dc4c3.png"></p><div class="codeBlockContainer_J+bg language-javascript theme-code-block"><div class="codeBlockContent_csEI javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> jsonData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">responseBody</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">environment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;AccessToken&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> jsonData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/postman">Postman</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/welcome">Welcome</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-08-26T00:00:00.000Z" itemprop="datePublished">August 26, 2021</time> · <!-- -->One min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://sebastienlorber.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/slorber.png" alt="Sébastien Lorber"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://sebastienlorber.com" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sébastien Lorber</span></a></div><small class="avatar__subtitle" itemprop="description">Docusaurus maintainer</small></div></div></div><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/yangshun" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/yangshun.png" alt="Yangshun Tay"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/yangshun" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Yangshun Tay</span></a></div><small class="avatar__subtitle" itemprop="description">Front End Engineer @ Facebook</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><a href="https://docusaurus.io/docs/blog" target="_blank" rel="noopener noreferrer">Docusaurus blogging features</a> are powered by the <a href="https://docusaurus.io/docs/api/plugins/@docusaurus/plugin-content-blog" target="_blank" rel="noopener noreferrer">blog plugin</a>.</p><p>Simply add Markdown files (or folders) to the <code>blog</code> directory.</p><p>Regular blog authors can be added to <code>authors.yml</code>.</p><p>The blog post date can be extracted from filenames, such as:</p><ul><li><code>2019-05-30-welcome.md</code></li><li><code>2019-05-30-welcome/index.md</code></li></ul><p>A blog post folder can be convenient to co-locate blog post images:</p><p><img alt="Docusaurus Plushie" src="/en/assets/images/docusaurus-plushie-banner-a60f7593abca1e3eef26a9afa244e4fb.jpeg"></p><p>The blog supports tags as well!</p><p><strong>And if you don&#x27;t want a blog</strong>: just delete this directory, and use <code>blog: false</code> in your Docusaurus config.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/facebook">facebook</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/hello">hello</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/docusaurus">docusaurus</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/mdx-blog-post">MDX Blog Post</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-08-01T00:00:00.000Z" itemprop="datePublished">August 1, 2021</time> · <!-- -->One min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://sebastienlorber.com" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/slorber.png" alt="Sébastien Lorber"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://sebastienlorber.com" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sébastien Lorber</span></a></div><small class="avatar__subtitle" itemprop="description">Docusaurus maintainer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Blog posts support <a href="https://docusaurus.io/docs/markdown-features" target="_blank" rel="noopener noreferrer">Docusaurus Markdown features</a>, such as <a href="https://mdxjs.com/" target="_blank" rel="noopener noreferrer">MDX</a>.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Use the power of React to create interactive blog posts.</p><div class="codeBlockContainer_J+bg language-js theme-code-block"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;button clicked!&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Click</span><span class="token plain"> me</span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><button>Click me!</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/docusaurus">docusaurus</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/long-blog-post">Long Blog Post</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2019-05-29T00:00:00.000Z" itemprop="datePublished">May 29, 2019</time> · <!-- -->3 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/endiliey" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/endiliey.png" alt="Endilie Yacop Sucipto"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/endiliey" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Endilie Yacop Sucipto</span></a></div><small class="avatar__subtitle" itemprop="description">Maintainer of Docusaurus</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>This is the summary of a very long blog post,</p><p>Use a <code>&lt;!--</code> <code>truncate</code> <code>--&gt;</code> comment to limit blog post size in the list view.</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/hello">hello</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/docusaurus">docusaurus</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Long Blog Post" href="/en/blog/long-blog-post"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/en/blog/first-blog-post">First Blog Post</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2019-05-28T00:00:00.000Z" itemprop="datePublished">May 28, 2019</time> · <!-- -->One min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/wgao19" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/wgao19.png" alt="Gao Wei"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/wgao19" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Gao Wei</span></a></div><small class="avatar__subtitle" itemprop="description">Docusaurus Core Team</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/hola">hola</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/en/blog/tags/docusaurus">docusaurus</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/en/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.624765fb.js"></script>
<script src="/en/assets/js/main.20fce998.js"></script>
</body>
</html>